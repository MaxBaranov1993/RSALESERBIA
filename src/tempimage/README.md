# Система сохранения изображений в tempimage

## Описание

Система автоматически сохраняет изображения, загруженные пользователями при добавлении товаров и услуг, в папку `tempimage`. Изображения сохраняются с уникальными именами и привязываются к пользователю.

## Функциональность

### Автоматическое сохранение
- При загрузке изображений в формах добавления товаров/услуг
- Изображения сохраняются с уникальными именами: `{userId}_{timestamp}.{extension}`
- Поддерживаемые форматы: PNG, JPG, GIF
- Максимальный размер файла: 10MB

### Управление изображениями
- Просмотр всех сохраненных изображений пользователя
- Удаление отдельных изображений
- Статистика по сохраненным изображениям
- Информация о размере, типе файла и дате загрузки

### Безопасность
- Изображения привязаны к конкретному пользователю
- Автоматическая очистка при удалении товаров
- Валидация типов файлов

## Структура файлов

```
src/tempimage/
├── README.md                    # Этот файл
├── utils/
│   └── imageStorage.js         # Утилиты для работы с изображениями
└── components/
    └── SavedImagesViewer.jsx   # Компонент просмотра изображений
```

## API функций

### `saveImageToTemp(file, userId)`
Сохраняет одно изображение в tempimage
- **file**: File объект изображения
- **userId**: ID пользователя
- **Возвращает**: Promise<string> - URL сохраненного изображения

### `saveMultipleImagesToTemp(files, userId)`
Сохраняет массив изображений
- **files**: Array<File> - массив файлов
- **userId**: ID пользователя
- **Возвращает**: Promise<string[]> - массив URL

### `getSavedImages(userId)`
Получает все сохраненные изображения пользователя
- **userId**: ID пользователя
- **Возвращает**: Array - массив информации об изображениях

### `deleteSavedImage(imageId)`
Удаляет сохраненное изображение
- **imageId**: ID изображения
- **Возвращает**: boolean - успешность удаления

### `clearUserTempImages(userId)`
Очищает все временные изображения пользователя
- **userId**: ID пользователя

### `getImageStorageStats()`
Получает статистику по сохраненным изображениям
- **Возвращает**: Object - статистика

## Использование в компонентах

### ImageUpload
Компонент автоматически сохраняет загруженные изображения:

```jsx
import { saveImageToTemp } from '../utils/imageStorage';

// В обработчике загрузки файлов
const savedUrl = await saveImageToTemp(file, userId);
```

### SavedImagesViewer
Компонент для просмотра сохраненных изображений:

```jsx
import SavedImagesViewer from '../components/SavedImagesViewer';

// В профиле пользователя
<SavedImagesViewer />
```

## Хранение данных

Изображения сохраняются в localStorage браузера с метаданными:
- ID изображения
- Имя файла
- URL для отображения
- Оригинальное имя файла
- Размер файла
- Тип файла
- ID пользователя
- Дата загрузки
- Виртуальный путь в tempimage

## Интеграция с товарами

При добавлении товара/услуги:
1. Изображения сохраняются в tempimage
2. URL изображений добавляются в данные товара
3. Информация о сохраненных изображениях привязывается к товару
4. При удалении товара изображения также удаляются

## Ограничения

- Изображения хранятся в localStorage браузера
- Максимальный размер зависит от доступного места в браузере
- При очистке данных браузера изображения будут потеряны
- В продакшене рекомендуется использовать серверное хранение

## Будущие улучшения

- Серверное хранение изображений
- Сжатие изображений перед сохранением
- Поддержка дополнительных форматов
- Автоматическая очистка старых изображений
- Кэширование изображений 